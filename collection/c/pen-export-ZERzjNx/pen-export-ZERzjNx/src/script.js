window.cardpath_card=0;window.cardpath_cards=[];window.cardpath_classic=[];window.cardpath_mode=0;var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var h="",l=0;for(c=Base64._utf8_encode(c);l<c.length;){var m=c.charCodeAt(l++);var v=c.charCodeAt(l++);var w=c.charCodeAt(l++);var A=m>>2;m=(m&3)<<4|v>>4;var B=(v&15)<<2|w>>6;var t=w&63;isNaN(v)?B=t=64:isNaN(w)&&(t=64);h=h+this._keyStr.charAt(A)+this._keyStr.charAt(m)+this._keyStr.charAt(B)+this._keyStr.charAt(t)}return h},decode:function(c){var h="",l=0;for(c=c.replace(/[^A-Za-z0-9\+\/=]/g,"");l<c.length;){var m=this._keyStr.indexOf(c.charAt(l++));var v=this._keyStr.indexOf(c.charAt(l++));var w=this._keyStr.indexOf(c.charAt(l++));var A=this._keyStr.indexOf(c.charAt(l++));m=m<<2|v>>4;v=(v&15)<<4|w>>2;var B=(w&3)<<6|A;h+=String.fromCharCode(m);64!=w&&(h+=String.fromCharCode(v));64!=A&&(h+=String.fromCharCode(B))}return h=Base64._utf8_decode(h)},_utf8_encode:function(c){c=c.replace(/\r\n/g,"\n");for(var h="",l=0;l<c.length;l++){var m=c.charCodeAt(l);128>m?h+=String.fromCharCode(m):(127<m&&2048>m?h+=String.fromCharCode(m>>6|192):(h+=String.fromCharCode(m>>12|224),h+=String.fromCharCode(m>>6&63|128)),h+=String.fromCharCode(m&63|128))}return h},_utf8_decode:function(c){var h="",l=0;for(c1=c2=0;l<c.length;){var m=c.charCodeAt(l);128>m?(h+=String.fromCharCode(m),l++):191<m&&224>m?(c2=c.charCodeAt(l+1),h+=String.fromCharCode((m&31)<<6|c2&63),l+=2):(c2=c.charCodeAt(l+1),c3=c.charCodeAt(l+2),h+=String.fromCharCode((m&15)<<12|(c2&63)<<6|c3&63),l+=3)}return h}};function unescape(c){return(c+"===".slice((c.length+3)%4)).replace(/-/g,"+").replace(/_/g,"/")}function escape(c){return c.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function translateSuit(c){return 0==c?"S":1==c?"C":2==c?"W":3==c?"P":""+c}function translateRank(c,h){return 4==h?22==c?"00":10>c?"0"+c:c:10==c?translateSuit(h)+"0":11==c?translateSuit(h)+"P":12==c?translateSuit(h)+"N":13==c?translateSuit(h)+"Q":14==c?translateSuit(h)+"K":translateSuit(h)+c}
function shuffleAgain(){document.getElementById("shuffle-again").classList.add("disabled");deck.shuffle();deck.fan()}
function swapShuffle(){var c=document.getElementById("cardarea-wrap"),h=document.getElementById("classicarea"),l=document.getElementById("shuffle-again");"none"==c.style.display?(c.style.display="block",h.style.display="none",l.style.display="inline-block",document.getElementById("swap-text").innerHTML="Classic"):(c.style.display="none",h.style.display="block",l.style.display="none",document.getElementById("swap-text").innerHTML="Virtual Tarot Deck");0==window.cardpath_mode&&(document.getElementById("swap-shuffle").classList.add("disabled"),deck.mount(cardarea),deck.intro(),deck.shuffle(),deck.shuffle(),deck.shuffle(),deck.fan())}document.getElementById("swap-shuffle").addEventListener("mousedown",swapShuffle);document.getElementById("shuffle-again").addEventListener("mousedown",shuffleAgain);var Deck=function(){function c(a,f){var b=Date.now()+a,d={start:b,end:b+f};D.push(d);H||(H=!0,requestAnimationFrame(h));var e={start:function(g){d.startcb=g;return e},progress:function(g){d.progresscb=g;return e},end:function(g){d.endcb=g;return e}};return e}function h(){var a=Date.now();if(a-O<1E3/60)requestAnimationFrame(h);else if(O=a,D.length){for(var f=0,b;f<D.length;f++)if(b=D[f],!(a<b.start)){b.started||(b.started=!0,b.startcb&&b.startcb());var d=(a-b.start)/(b.end-b.start);b.progresscb&&b.progresscb(1>d?d:1);a>b.end&&(b.endcb&&b.endcb(),D.splice(f--,1))}requestAnimationFrame(h)}else H=!1}function l(a){if("undefined"!==typeof F[a])return F[a];if("undefined"!==typeof P[a])return F[a]=a;for(var f=a[0].toUpperCase()+a.slice(1),b=["webkit","moz","Moz","ms","o"],d,e=0,g=b.length;e<g;e++)if(d=b[e]+f,"undefined"!==typeof P[d])return F[a]=d}function m(a,f,b){if("undefined"===typeof x)if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var d=l("transform"),e=document.createElement("p");document.body.appendChild(e);e.style[d]="translate3d(1px,1px,1px)";x=e.style[d];x=null!=x&&x.length&&"none"!==x;document.body.removeChild(e)}else x=!1;return x?"translate3d("+a+", "+f+", "+(b||0)+")":"translate("+a+", "+f+")"}function v(a){function f(q){q.card&&q.card(k)}function b(q){function r(I){E&&window.cardpath_card<=window.xcards.length&&1<=window.cardpath_mode&&k.setSide("front");"mouseup"===I.type?window.removeEventListener("mouseup",r):window.removeEventListener("touchend",r);C&&(k.x=k.x+
y.x-u.x,k.y=k.y+y.y-u.y)}var u={},y={};Date.now();q.preventDefault();10>=window.cardpath_card&&("mousedown"===q.type?(u.x=y.x=q.clientX,u.y=y.y=q.clientY,window.addEventListener("mouseup",r)):(u.x=y.x=q.touches[0].clientX,u.y=y.y=q.touches[0].clientY,window.addEventListener("touchend",r)));C&&n.hasAttribute("id")}var d=l("transform");if(55>=a)var e=a%14+1,g=a/14|0;else e=78-a,g=4;var p=78-a,n=document.createElement("div"),z=document.createElement("div"),J=document.createElement("div"),C=!1,E=!1,k={i:a,rank:e,suit:g,pos:a,$el:n,mount:function(q){q.appendChild(n);k.$root=q},unmount:function(){k.$root&&k.$root.removeChild(n);k.$root=null},setSide:function(q){if("front"===q){if("back"===k.side&&n.removeChild(J),k.side="front",n.appendChild(z),k.setRankSuit(k.rank,k.suit),1<=window.cardpath_card&&window.cardpath_cards.length<window.cardpath_card?(num=window.cardpath_card-1,window.cardpath_cards[num]=[k.suit,k.rank],n.style.zIndex=num+78,document.getElementById("cardarea-wrap"),this.animateTo({delay:100,duration:400,x:xcards[num],y:ycards[num],rot:rotcards[num]})):1<=window.cardpath_card&&(num=window.cardpath_card-1,cardid=translateRank(window.cardpath_cards[num][1],window.cardpath_cards[num][0])),window.cardpath_cards.length==window.xcards.length&&1==window.cardpath_mode){document.getElementById("goreading").style.opacity=0;document.getElementById("goreading").style.display="";document.getElementById("shuffle-again").innerHTML="&nsbp;";document.getElementById("shuffle-again").style.opacity=0;document.getElementById("swap-shuffle").innerHTML="&nsbp;";document.getElementById("swap-shuffle").style.opacity=0;document.getElementById("swap-shuffle").removeEventListener("mousedown",swapShuffle);var r=+new Date,u=function(){document.getElementById("goreading").style.opacity=+document.getElementById("goreading").style.opacity+(new Date-r)/400;r=+new Date;1>+document.getElementById("goreading").style.opacity&&(window.requestAnimationFrame&&requestAnimationFrame(u)||setTimeout(u,16))};u();window.cardpath_mode=2}}else"front"===k.side&&(n.removeChild(z),n.hasAttribute("id")&&n.removeAttribute("id")),k.side="back",n.appendChild(J),n.setAttribute("class","card")}};a=t.modules;var Q;z.classList.add("face");J.classList.add("back");n.style[d]=m(-p+"px",-p+"px");k.x=-p;k.y=-p;k.z=p;k.rot=0;k.setSide("back");n.addEventListener("mousedown",b);n.addEventListener("touchstart",b);for(Q in a)f(a[Q]);k.animateTo=function(q){var r=q.x,u=void 0===r?k.x:r;r=q.y;var y=void 0===r?k.y:r;r=q.rot;var I=void 0===r?k.rot:r,Y=q.ease,R=q.onStart,S=q.onProgress,T=q.onComplete,K,L,M,U,V,N;c(q.delay,q.duration).start(function(){K=k.x||0;L=k.y||0;M=k.rot||0;R&&R()}).progress(function(W){var G=X[Y||"cubicInOut"](W);U=u-K;V=y-L;N=I-M;S&&S(W,G);k.x=K+U*G;k.y=L+V*G;k.rot=M+N*G;n.style[d]=m(k.x+"px",k.y+"px")+(N?"rotate("+k.rot+"deg)":"")}).end(function(){T&&T()})};k.setRankSuit=function(q,r){n.setAttribute("class","card "+(0===r?"swords":1===r?"cups":2===r?"wands":3===r?"pentacles":"major")+" rank"+q)};k.setRankSuit(e,g);k.enableDragging=function(){C||(C=!0,n.style.cursor="move")};k.enableFlipping=function(){E||(E=!0)};k.disableFlipping=function(){E&&(E=!1)};k.disableDragging=function(){C&&(C=!1,n.style.cursor="")};return k}function w(a){for(var f,b,d=a.length-1;d;d--)f=Math.random()*d|0,b=a[d],a[d]=a[f],a[f]=b;return a}function A(a){function f(g){g&&(e.push(g),1===e.length&&b())}function b(){e[0](function(g){if(g)throw g;e=e.slice(1);e.length&&b()})}var d=Array.prototype,e=[];a.queue=f;a.queued=function(g){return function(){var p=this,n=arguments;f(function(z){g.apply(p,d.concat.apply(z,n))})}};return a}function B(a){a||(a={});var f={};a.on=function(b,d,e){f[b]||(f[b]=[]);f[b].push({cb:d,ctx:e})};a.one=function(b,d,e){f[b]||(f[b]=[]);f[b].push({cb:d,ctx:e,once:!0})};a.off=function(b,d){b?f[b]=d?f[b].filter(function(e){return e.cb!==d}):[]:f={}};a.trigger=function(b){var d=this,e=Array.prototype.slice(arguments,1);(f[b]||[]).filter(function(g){g.cb.apply(d,e);return!g.once})};return a}function t(a){function f(n){n.deck&&n.deck(d)}a=Array(78);var b=document.createElement("div"),d=B({mount:function(n){e=n;e.appendChild(b)},unmount:function(){e.removeChild(b)},cards:a,$el:b}),e,g=t.modules;A(d);for(p in g)f(g[p]);b.classList.add("deck");for(g=a.length;g;g--){var p=a[g-1]=v(g-1);p.mount(b)}return d}var H,D=[],O=0;window.requestAnimationFrame||(window.requestAnimationFrame=function(a){setTimeout(a,0)});var P=document.createElement("p").style,F={},x,X={linear:function(a){return a},quadIn:function(a){return a*a},quadOut:function(a){return a*(2-a)},quadInOut:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},cubicIn:function(a){return a*a*a},cubicOut:function(a){return--a*a*a+1},cubicInOut:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},quartIn:function(a){return a*a*a*a},quartOut:function(a){return 1- --a*a*a*a},quartInOut:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},quintIn:function(a){return a*a*a*a*a},quintOut:function(a){return 1+--a*a*a*a*a},quintInOut:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}};t.animationFrames=c;t.ease=X;t.modules={intro:{deck:function(a){a.intro=a.queued(function(f){var b=a.cards;b.forEach(function(d,e){d.setSide("front");d.intro(e,function(g){c(250,0).start(function(){d.setSide("back")});g===b.length-1&&f()})})})},card:function(a){var f=l("transform"),b=a.$el;a.intro=function(d,e){var g=500+10*d,p=d/4,n=document.getElementById("cardarea-wrap").clientHeight-90;b.style[f]=m(-p+"px","-250px");b.style.opacity=0;a.x=-p+5;a.y=n-p;a.rot=0;a.animateTo({delay:g,duration:1E3,x:-p+5,y:n-p,onStart:function(){b.style.zIndex=d},onProgress:function(z){b.style.opacity=z},onComplete:function(){b.style.opacity="";e&&e(d)}})}}},shuffle:{deck:function(a){a.shuffle=a.queued(function(f){window.cardpath_num=1;window.cardpath_card=0;window.cardpath_cards=[];var b=a.cards;w(b);b.forEach(function(d,e){d.pos=e;d.setSide("back");d.shuffle(function(g){g===b.length-1&&f()})})})},card:function(a){var f=a.$el;a.shuffle=function(b){var d=a.pos,e=d/4,g=document.getElementById("cardarea-wrap").clientHeight-90,p=2*d;a.animateTo({delay:p,duration:200,x:(Math.round(Math.random())?-1:1)*(50*Math.random()+20),y:g-e,rot:0});a.animateTo({delay:200+p,duration:200,x:-e+5,y:g-e,rot:0,onStart:function(){f.style.zIndex=d},onComplete:function(){b(d)}})}}},sort:{deck:function(a){a.sort=a.queued(function(f,b){var d=a.cards;d.sort(function(e,g){return b?e.i-g.i:g.i-e.i});d.forEach(function(e,g){e.sort(g,d.length,function(p){p===d.length-1&&f()},b)})})},card:function(a){a.sort=function(f,b,d,e){b=f/4;e=10*f;var g=document.getElementById("cardarea-wrap").clientHeight-90;a.animateTo({delay:e,duration:400,x:-b+5,y:g-150,rot:0,onComplete:function(){}});a.animateTo({delay:e+500,duration:400,x:-b+5,y:g-b,rot:0,onComplete:function(){d(f)}})}}},flip:{deck:function(a){a.flip=a.queued(function(f){a.cards.filter(function(b){return"front"===b.side});a.cards.forEach(function(b,d){b.setSide("back")});f()})}},fan:{deck:function(a){a.fan=a.queued(function(f){var b=a.cards,d=b.length;b.forEach(function(e,g){e.fan(g,d,function(p){p===b.length-1&&(f(),0==window.cardpath_mode&&setTimeout(addCardListeners,100))})});document.getElementById("swap-shuffle").classList.remove("disabled");document.getElementById("shuffle-again").classList.remove("disabled")})},card:function(a){var f=a.$el;a.fan=function(b,d,e){d=document.getElementById("cardarea-wrap").clientHeight-90;document.getElementById("cardarea-wrap");var g=b/4,p=10*b;a.animateTo({delay:p,duration:300,x:-g+5,y:d-g,rot:0});a.animateTo({delay:300+p,duration:300,x:(39>b?-127:-400)+7*b,y:39>b?d-90:d,onStart:function(){f.style.zIndex=b},onComplete:function(){e(b)}})}}}};t.Card=v;t.prefix=l;t.translate=m;return t}(),prefix=Deck.prefix,transform=prefix("transform"),translate=Deck.translate,cardarea=document.getElementById("cardarea"),deck=Deck();function onEnd(){}
document.getElementById("gobutton").addEventListener("mousedown",function(){if(window.cardpath_cards.length=window.xcards.length){var c="https://www.trustedtarot.com/set/set_shuffle.php?";for(i=0;i<window.cardpath_cards.length;i++)c=0==i?c+("c"+i+"="+window.cardpath_cards[i][1]+"r"+window.cardpath_cards[i][0]):c+("&c"+i+"="+window.cardpath_cards[i][1]+"r"+window.cardpath_cards[i][0]);c="";for(i=0;i<window.cardpath_cards.length;i++)c+=translateRank(window.cardpath_cards[i][1],window.cardpath_cards[i][0]);c=window.cardpath_type[0]+c;c=escape(Base64.encode(c));console.log(c);c="https://www.trustedtarot.com/"+window.cardpath_type[2]+"/?step=1&r="+c;window.location.href=c}});function resetWrapBg(c){document.getElementById("cardarea-wrap").className="cardarea_bg"+c}
function addCardListeners(){deck.cards.forEach(function(c,h){c.enableFlipping();c.$el.addEventListener("mouseup",onEnd);c.$el.addEventListener("touchend",onEnd);c.$el.addEventListener("mousedown",onStart);c.$el.addEventListener("touchstart",onStart)});window.cardpath_mode=1}
function onStart(){this.hasAttribute("id")?window.cardpath_card=this.id:(window.cardpath_card<=window.xcards.length&&window.cardpath_num<=window.xcards.length?(this.setAttribute("id",window.cardpath_num),window.cardpath_card=this.id):window.cardpath_card=99,window.cardpath_num++)}
var now=new Date,start=new Date(now.getFullYear(),0,0),diff=now-start+6E4*(start.getTimezoneOffset()-now.getTimezoneOffset()),oneDay=864E5,day=Math.floor(diff/oneDay),hour=now.getHours(),minute=now.getMinutes(),second=now.getSeconds(),classicnum=day+hour+minute+second,classicurl="/fast/json/spreads/"+classicnum+".json";window.classicShuffle=JSON.parse('{"1":"SN","2":"SQ","3":"P3","4":"S0","5":"S7","6":"09","7":"02","8":"20","9":"P5","10":"C2","11":"W5","12":"06","13":"W8","14":"11","15":"PQ","16":"WN","17":"S4","18":"01","19":"07","20":"03","21":"S1","22":"W0","23":"S2","24":"12","25":"W1","26":"P4","27":"C4","28":"P8","29":"S5","30":"P2","31":"21","32":"WK","33":"CQ","34":"SP","35":"S6","36":"16","37":"P0","38":"15","39":"P6","40":"S3","41":"C5","42":"14","43":"P1","44":"13","45":"C0","46":"PP","47":"C1","48":"C9","49":"08","50":"10","51":"C3","52":"W7","53":"S8","54":"CP","55":"S9","56":"04","57":"P7","58":"W6","59":"P9","60":"CN","61":"C6","62":"WP","63":"SK","64":"CK","65":"W3","66":"PK","67":"C7","68":"05","69":"PN","70":"C8","71":"W4","72":"W9","73":"17","74":"00","75":"W2","76":"WQ","77":"19","78":"18"}');var request=new XMLHttpRequest;request.open("GET",classicurl,!0);request.onload=function(){200<=request.status&&400>request.status&&(window.classicShuffle=JSON.parse(request.responseText),console.log("ready"))};request.onerror=function(){window.classicShuffle=JSON.parse({1:"SN",2:"SQ",3:"P3",4:"S0",5:"S7",6:"09",7:"02",8:"20",9:"P5",10:"C2",11:"W5",12:"06",13:"W8",14:"11",15:"PQ",16:"WN",17:"S4",18:"01",19:"07",20:"03",21:"S1",22:"W0",23:"S2",24:"12",25:"W1",26:"P4",27:"C4",28:"P8",29:"S5",30:"P2",31:"21",32:"WK",33:"CQ",34:"SP",35:"S6",36:"16",37:"P0",38:"15",39:"P6",40:"S3",41:"C5",42:"14",43:"P1",44:"13",45:"C0",46:"PP",47:"C1",48:"C9",49:"08",50:"10",51:"C3",52:"W7",53:"S8",54:"CP",55:"S9",56:"04",57:"P7",58:"W6",59:"P9",60:"CN",61:"C6",62:"WP",63:"SK",64:"CK",65:"W3",66:"PK",67:"C7",68:"05",69:"PN",70:"C8",71:"W4",72:"W9",73:"17",74:"00",75:"W2",76:"WQ",77:"19",78:"18"})};request.send();for(var processClassicChoose=function(c){var h=window.xcards.length;c.preventDefault();c=this.getAttribute("id");window.cardpath_classic.length<h&&(card=window.classicShuffle[c],this.src="/images/small/"+card+".png",this.removeAttribute("id"),this.removeEventListener("mousedown",processClassicChoose),window.cardpath_classic.push(card),cardpath_classic.length>=h&&(h=window.cardpath_type[0]+window.cardpath_classic.join(""),h=escape(Base64.encode(h)),decodedString=Base64.decode(unescape(h)),url="https://www.trustedtarot.com/"+
window.cardpath_type[2]+"/?step=1&r="+h,window.location.href=url))},classicclass=document.getElementsByClassName("choose-card"),i=0;i<classicclass.length;i++)classicclass[i].addEventListener("mousedown",processClassicChoose)